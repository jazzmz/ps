/* #4228 ╚эъы■ф фы  ёючфрэш  Excel Їрщыр ё ЁххёЄЁюь */

FUNCTION XLHead RETURNS CHAR (INPUT tday AS CHAR): 
DEF VAR ret_str as CHAR.

ret_str =
"<?xml version=""1.0""?>" + CHR(10) +
"<?mso-application progid=""Excel.Sheet""?>" + CHR(10) +
"<Workbook xmlns=""urn:schemas-microsoft-com:office:spreadsheet""" + CHR(10) +
" xmlns:o=""urn:schemas-microsoft-com:office:office""" + CHR(10) +
" xmlns:x=""urn:schemas-microsoft-com:office:excel""" + CHR(10) +
" xmlns:ss=""urn:schemas-microsoft-com:office:spreadsheet""" + CHR(10) +
" xmlns:html=""http://www.w3.org/TR/REC-html40"">" + CHR(10) +
 "<DocumentProperties xmlns=""urn:schemas-microsoft-com:office:office"">" + CHR(10) +
  "<Author>ООО ПИР Банк</Author>" + CHR(10) +
  "<LastAuthor>ООО ПИР Банк</LastAuthor>" + CHR(10) +
  "<LastPrinted>2013-12-11T09:24:59Z</LastPrinted>" + CHR(10) +
  "<Created>2013-12-11T09:24:59Z</Created>" + CHR(10) +
  "<Company>ООО ПИР Банк</Company>" + CHR(10) +
  "<Version>11.9999</Version>" + CHR(10) +
 "</DocumentProperties>" + CHR(10) +
 "<ExcelWorkbook xmlns=""urn:schemas-microsoft-com:office:excel"">" + CHR(10) +
  "<WindowHeight>12585</WindowHeight>" + CHR(10) +
  "<WindowWidth>15315</WindowWidth>" + CHR(10) +
  "<WindowTopX>120</WindowTopX>" + CHR(10) +
  "<WindowTopY>30</WindowTopY>" + CHR(10) +
  "<ProtectStructure>False</ProtectStructure>" + CHR(10) +
  "<ProtectWindows>False</ProtectWindows>" + CHR(10) +
 "</ExcelWorkbook>" + CHR(10) +
 "<Styles>" + CHR(10) +
  "<Style ss:ID=""Default"" ss:Name=""Normal"">" + CHR(10) +
   "<Alignment ss:Vertical=""Bottom""/>" + CHR(10) +
   "<Borders/>" + CHR(10) +
   "<Font ss:FontName=""Arial Cyr"" x:CharSet=""204""/>" + CHR(10) +
   "<Interior/>" + CHR(10) +
   "<NumberFormat/>" + CHR(10) +
   "<Protection/>" + CHR(10) +
  "</Style>" + CHR(10) +
  "<Style ss:ID=""s21"">" + CHR(10) +
   "<Font ss:FontName=""Arial Cyr"" x:CharSet=""204"" ss:Size=""12""/>" + CHR(10) +
  "</Style>" + CHR(10) +
  "<Style ss:ID=""s23"">" + CHR(10) +
   "<Alignment ss:Horizontal=""Center"" ss:Vertical=""Bottom""/>" + CHR(10) +
   "<Font ss:FontName=""Times New Roman"" x:CharSet=""204"" x:Family=""Roman""" + CHR(10) +
   " ss:Size=""12"" ss:Bold=""1""/>" + CHR(10) +
  "</Style>" + CHR(10) +
  "<Style ss:ID=""s24"">" + CHR(10) +
   "<Alignment ss:Horizontal=""Center"" ss:Vertical=""Bottom""/>" + CHR(10) +
   "<Font ss:FontName=""Times New Roman"" x:CharSet=""204"" x:Family=""Roman""" + CHR(10) +
   " ss:Size=""12""/>" + CHR(10) +
  "</Style>" + CHR(10) +
  "<Style ss:ID=""s27"">" + CHR(10) +
   "<Alignment ss:Horizontal=""Left"" ss:Vertical=""Bottom""/>" + CHR(10) +
   "<Font ss:FontName=""Times New Roman"" x:CharSet=""204"" x:Family=""Roman""" + CHR(10) +
   " ss:Size=""12""/>" + CHR(10) +
  "</Style>" + CHR(10) +
  "<Style ss:ID=""s28"">" + CHR(10) +
   "<Alignment ss:Horizontal=""Justify"" ss:Vertical=""Bottom""/>" + CHR(10) +
   "<Font ss:FontName=""Times New Roman"" x:CharSet=""204"" x:Family=""Roman""" + CHR(10) +
   " ss:Size=""12""/>" + CHR(10) +
  "</Style>" + CHR(10) +
  "<Style ss:ID=""s29"">" + CHR(10) +
   "<Alignment ss:Horizontal=""Center"" ss:Vertical=""Center"" ss:WrapText=""1""/>" + CHR(10) +
   "<Borders>" + CHR(10) +
    "<Border ss:Position=""Bottom"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
    "<Border ss:Position=""Left"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
    "<Border ss:Position=""Right"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
    "<Border ss:Position=""Top"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
   "</Borders>" + CHR(10) +
   "<Font ss:FontName=""Times New Roman"" x:CharSet=""204"" x:Family=""Roman""" + CHR(10) +
   " ss:Size=""12"" ss:Color=""#000000"" ss:Bold=""1""/>" + CHR(10) +
  "</Style>" + CHR(10) +
  "<Style ss:ID=""s30"">" + CHR(10) +
   "<Alignment ss:Vertical=""Bottom"" ss:WrapText=""1""/>" + CHR(10) +
   "<Font ss:FontName=""Times New Roman"" x:CharSet=""204"" x:Family=""Roman""" + CHR(10) +
   " ss:Size=""12""/>" + CHR(10) +
  "</Style>" + CHR(10) +
  "<Style ss:ID=""s31"">" + CHR(10) +
   "<Alignment ss:Horizontal=""Center"" ss:Vertical=""Bottom""/>" + CHR(10) +
   "<Borders>" + CHR(10) +
    "<Border ss:Position=""Bottom"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
    "<Border ss:Position=""Left"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
    "<Border ss:Position=""Right"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
    "<Border ss:Position=""Top"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
   "</Borders>" + CHR(10) +
   "<Font ss:FontName=""Times New Roman"" x:CharSet=""204"" x:Family=""Roman""" + CHR(10) +
   " ss:Size=""12""/>" + CHR(10) +
  "</Style>" + CHR(10) +
  "<Style ss:ID=""s32"">" + CHR(10) +
   "<Borders>" + CHR(10) +
    "<Border ss:Position=""Bottom"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
    "<Border ss:Position=""Left"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
    "<Border ss:Position=""Right"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
    "<Border ss:Position=""Top"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
   "</Borders>" + CHR(10) +
   "<Font ss:FontName=""Times New Roman"" x:CharSet=""204"" x:Family=""Roman""" + CHR(10) +
   " ss:Size=""12"" ss:Color=""#000000""/>" + CHR(10) +
  "</Style>" + CHR(10) +
  "<Style ss:ID=""s33"">" + CHR(10) +
   "<Borders>" + CHR(10) +
    "<Border ss:Position=""Bottom"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
    "<Border ss:Position=""Left"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
    "<Border ss:Position=""Right"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
    "<Border ss:Position=""Top"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
   "</Borders>" + CHR(10) +
   "<Font ss:FontName=""Arial Cyr"" x:CharSet=""204"" ss:Size=""12""/>" + CHR(10) +
  "</Style>" + CHR(10) +
  "<Style ss:ID=""s34"">" + CHR(10) +
   "<Alignment ss:Horizontal=""Center"" ss:Vertical=""Bottom""/>" + CHR(10) +
   "<Borders>" + CHR(10) +
   "<Border ss:Position=""Bottom"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
   "<Border ss:Position=""Left"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
   "<Border ss:Position=""Right"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
   "<Border ss:Position=""Top"" ss:LineStyle=""Continuous"" ss:Weight=""1""/>" + CHR(10) +
   "</Borders>" + CHR(10) +
   "<Font ss:FontName=""Times New Roman"" x:CharSet=""204"" x:Family=""Roman""" + CHR(10) +
   " ss:Size=""12""/>" + CHR(10) +
   "<NumberFormat ss:Format=""Short Date""/>" + CHR(10) +
  "</Style>" + CHR(10) +
 "</Styles>" + CHR(10) +
 "<Worksheet ss:Name=""Реестр"">" + CHR(10) +
  "<Table ss:ExpandedColumnCount=""5"" ss:ExpandedRowCount=""3000"" x:FullColumns=""1""" + CHR(10) +
   "x:FullRows=""1"" ss:StyleID=""s21"" ss:DefaultRowHeight=""15"">" + CHR(10) +
   "<Column ss:StyleID=""s21"" ss:AutoFitWidth=""0"" ss:Width=""39.75""/>" + CHR(10) +
   "<Column ss:StyleID=""s21"" ss:AutoFitWidth=""0"" ss:Width=""180""/>" + CHR(10) +
   "<Column ss:StyleID=""s21"" ss:AutoFitWidth=""0"" ss:Width=""105""/>" + CHR(10) +
   "<Column ss:StyleID=""s21"" ss:AutoFitWidth=""0"" ss:Width=""105.75""/>" + CHR(10) +
   "<Row ss:AutoFitHeight=""0"" ss:Height=""14.25"">" + CHR(10) +
    "<Cell ss:MergeAcross=""3"" ss:StyleID=""s23""><Data ss:Type=""String"">Реестр № __ от |tday|</Data></Cell>" + CHR(10) +
   "</Row>" + CHR(10) +
   "<Row ss:AutoFitHeight=""0"">" + CHR(10) +
    "<Cell ss:MergeAcross=""3"" ss:StyleID=""s24""><Data ss:Type=""String"">к Договору № 9/ДК/13 от ""14"" октября 2013 г. </Data></Cell>" + CHR(10) +
   "</Row>" + CHR(10) +
   "<Row ss:AutoFitHeight=""0"">" + CHR(10) +
    "<Cell ss:StyleID=""s24""/>" + CHR(10) +
   "</Row>" + CHR(10) +
   "<Row ss:AutoFitHeight=""0"">" + CHR(10) +
    "<Cell ss:MergeAcross=""3"" ss:StyleID=""s27""><Data ss:Type=""String"">       В соответствии с условиями Договора Банк направляет Компании </Data></Cell>" + CHR(10) +
   "</Row>" + CHR(10) +
   "<Row ss:AutoFitHeight=""0"">" + CHR(10) +
    "<Cell ss:MergeAcross=""3"" ss:StyleID=""s27""><Data ss:Type=""String"">информациюв целях включения Клиентов в Дисконтную программу.</Data></Cell>" + CHR(10) +
   "</Row>" + CHR(10) +
   "<Row ss:AutoFitHeight=""0"">" + CHR(10) +
    "<Cell ss:StyleID=""s28""/>" + CHR(10) +
   "</Row>" + CHR(10) +
   "<Row ss:AutoFitHeight=""0"" ss:Height=""82.5"">" + CHR(10) +
    "<Cell ss:StyleID=""s29""><Data ss:Type=""String"">№ п/п</Data></Cell>" + CHR(10) +
    "<Cell ss:StyleID=""s29""><Data ss:Type=""String"">Номер Клиента, присваиваемый для включения Клиента в Дисконтную программу</Data></Cell>" + CHR(10) +
    "<Cell ss:StyleID=""s29""><Data ss:Type=""String"">Начало Срока действия Скидки</Data></Cell>" + CHR(10) +
    "<Cell ss:StyleID=""s29""><Data ss:Type=""String"">Окончание Срока действия Скидки</Data></Cell>" + CHR(10) +
    "<Cell ss:StyleID=""s30""/>" + CHR(10) +
   "</Row>".

ret_str = REPLACE(ret_str,"|tday|",tday).

RETURN ret_str.

END FUNCTION.


FUNCTION XLAddRow RETURNS CHAR (INPUT Count AS INT, INPUT ClNum AS CHAR, INPUT InDate AS CHAR, INPUT OutDate AS CHAR): 
DEF VAR ret_str as CHAR.

ret_str =
   "<Row ss:AutoFitHeight=""0"" ss:Height=""15.75"">" + CHR(10) +
    "<Cell ss:StyleID=""s31""><Data ss:Type=""String"">|Count|</Data></Cell>" + CHR(10) +
    "<Cell ss:StyleID=""s31""><Data ss:Type=""String"">|ClNum|</Data></Cell>" + CHR(10) +
    "<Cell ss:StyleID=""s34""><Data ss:Type=""DateTime"">|InDate|</Data></Cell>" + CHR(10) +
    "<Cell ss:StyleID=""s34""><Data ss:Type=""DateTime"">|OutDate|</Data></Cell>" + CHR(10) +
    "<Cell ss:StyleID=""s30""/>" + CHR(10) +
   "</Row>".                 

ret_str = REPLACE(ret_str,"|Count|",STRING(Count)).
ret_str = REPLACE(ret_str,"|ClNum|",ClNum).
ret_str = REPLACE(ret_str,"|InDate|",InDate).
ret_str = REPLACE(ret_str,"|OutDate|",OutDate).

RETURN ret_str.

END FUNCTION.


FUNCTION XLFoot RETURNS CHAR (INPUT Count AS INT): 
DEF VAR ret_str as CHAR.

ret_str =
   "<Row ss:AutoFitHeight=""0"">" + CHR(10) +
    "<Cell ss:StyleID=""s32""><Data ss:Type=""String"">Количество Клиентов согласно настоящему Реестру составляет |Count| человек(а).</Data></Cell>" + CHR(10) +
    "<Cell ss:StyleID=""s32""/>" + CHR(10) +
    "<Cell ss:StyleID=""s33""/>" + CHR(10) +
    "<Cell ss:StyleID=""s32""/>" + CHR(10) +
    "<Cell ss:StyleID=""s30""/>" + CHR(10) +
   "</Row>" + CHR(10) +
  "</Table>" + CHR(10) +
  "<WorksheetOptions xmlns=""urn:schemas-microsoft-com:office:excel"">" + CHR(10) +
   "<PageSetup>" + CHR(10) +
    "<Header x:Margin=""0.51181102362204722""/>" + CHR(10) +
    "<Footer x:Margin=""0.51181102362204722""/>" + CHR(10) +
    "<PageMargins x:Bottom=""0.98425196850393704"" x:Left=""0.98425196850393704""" + CHR(10) +
    "x:Right=""0.98425196850393704"" x:Top=""0.98425196850393704""/>" + CHR(10) +
   "</PageSetup>" + CHR(10) +
   "<Unsynced/>" + CHR(10) +
   "<Print>" + CHR(10) +
    "<ValidPrinterInfo/>" + CHR(10) +
    "<PaperSizeIndex>9</PaperSizeIndex>" + CHR(10) +
    "<HorizontalResolution>600</HorizontalResolution>" + CHR(10) +
    "<VerticalResolution>600</VerticalResolution>" + CHR(10) +
   "</Print>" + CHR(10) +
   "<Selected/>" + CHR(10) +
   "<Panes>" + CHR(10) +
    "<Pane>" + CHR(10) +
     "<Number>3</Number>" + CHR(10) +
     "<RangeSelection>R1C1:R1C4</RangeSelection>" + CHR(10) +
    "</Pane>" + CHR(10) +
   "</Panes>" + CHR(10) +
   "<ProtectObjects>False</ProtectObjects>" + CHR(10) +
   "<ProtectScenarios>False</ProtectScenarios>" + CHR(10) +
  "</WorksheetOptions>" + CHR(10) +
 "</Worksheet>" + CHR(10) +
"</Workbook>".

ret_str = REPLACE(ret_str,"|Count|",STRING(Count)).

RETURN ret_str.

END FUNCTION.